# 27ì¥ ë©”ì´ë¸ê³¼ ìŠ¤í”„ë§ STS ì‚¬ìš©ë²•

> * ì´ë²ˆì¥ì€ ì–´ë–»ê²Œ ì§„í–‰í•´ì•¼í• ê¹Œ? ğŸƒ
>   * Maven ë¹Œë“œ í”„ë¡œì íŠ¸ ìƒì„±
>   
>     * 26ì¥ Gralde ë¹Œë“œë¡œ ì‘ì„±í•œ í”„ë¡œì íŠ¸ë¥¼ Maven ë¹Œë“œ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•´ë´ë„ ì¢‹ì„ ê²ƒ ê°™ê¸´í•˜ë‹¤.. 
>     * Gretty ëŒ€ì‹  [cargo-maven-plugin](https://codehaus-cargo.github.io/cargo/Maven+3+Plugin.html)ìœ¼ë¡œ Tomcat ì‹¤í–‰ë˜ê²Œ ì„¤ì •í•˜ì.
>   
>   * STS ì‚¬ìš©ë²•, MyBatis ì‚¬ìš© ë“±ë“±...
>   
>     * IntelliJ ì‚¬ìš©ì¤‘ì´ë‹ˆ ë„˜ì–´ê°€ì. ìš”ì¦˜ InteliJì˜ MyBatis ì§€ì›ì´ ê½¤ ì¢‹ì•„ì¡Œë‹¤. (Mapper ì¸í„°í˜ì´ìŠ¤ ë¹ˆ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ” ê²½ê³ ê°€ ìˆì–´ì™”ëŠ”ë°.. í•´ê²°ëœë“¯.)
>   
>   * Apache Log4J
>   
>     * ë¡œê¹…ì€ ìŠ¤í„°ë”” ì‹œì‘í•  ë•Œë¶€í„° ì ìš©í•´ì„œ, ì¶”ê°€ë¡œ í•  ì¼ì€ ì—†ì„ ê²ƒ ê°™ë‹¤.  `Slf4j êµ¬í˜„ìœ¼ë¡œ Log4j2 ì‚¬ìš©í•˜ê³  ìˆìŒ.`
>   
>   * Apache Tiles
>   
>     * [Tiles](https://tiles.apache.org/framework/index.html)ê°€ 2017ë…„ 3.0.8 ë²„ì „ì´í›„ë¡œ ì‹ ë²„ì „ì´ ë‚˜ì˜¤ì§€ì•Šê³  ê°œë°œ ì¤‘ë‹¨ëœ ê²ƒ ê°™ì€ë°...
>       * ìƒˆë¡œ Maven ë¹Œë“œë¡œ ë¶„ê¸°í•œ í”„ë¡œì íŠ¸ì—ëŠ” ì ìš©í•´ë´ë„ ë  ê²ƒ ê°™ê¸´í•¨.
>     * âœ¨ Gradle ë¹Œë“œ í”„ë¡œì íŠ¸ì˜ ê²½ìš°... ì•„ì§ Viewê°€ ë³µì¡í•˜ì§„ ì•Šì•„ì„œ ì´ë²ˆê¸°íšŒì— `Thymeleaf`ë¡œ ë°”ê¿”ë´ë„ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
>   
>     
>   
>     	
>   
> * ì˜ˆì œ í”„ë¡œì íŠ¸
>   * Gradle ë¹Œë“œ
>     * [pro27](pro27)
>   * Maven ë¹Œë“œ
>     * [pro27-maven](pro27-maven)



## 27.1 ë©”ì´ë¸ ì„¤ì¹˜í•˜ê¸°

* ...
* Mavenì— ëŒ€í•´ì„œëŠ” ì´ë¯¸ ì˜ ì•Œê³  ìˆê³ , ì˜ ì“°ê³ ë„ ìˆì–´ì„œ...ğŸ˜… 
* Gradle í”„ë¡œì íŠ¸ë„ Maven í”„ë¡œì íŠ¸ë¡œ ì„±ê³µì ìœ¼ë¡œ ì „í™˜í–ˆë‹¤. ğŸ‘



## 27.2 ë©”ì´ë¸ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •í•˜ê¸°

* ...



## 27.3 STS ì„¤ì¹˜í•˜ê¸°

* ...
* STSëŠ” ì•ˆì“°ê¸°ë¡œ í•¨.. IntelliJë¡œ ëª¨ë“ ê²ƒì´ ì•„ì£¼ ì˜ë˜ê³  ìˆìŒ..ğŸ˜…



## 27.4 ë©”ì´ë¸ í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ì™€ êµ¬ì„± ìš”ì†Œ

* ...
* ì†”ì§íˆ ì¼ì°Œê°ì¹˜ ë¹Œë“œ íˆ´ì„ ì“°ëŠ” ì‹ìœ¼ë¡œ ì§„ë„ê°€ êµ¬ì„±ë˜ì—ˆì–´ì•¼ í–ˆë‹¤ê³  ìƒê°ì´ ë“œëŠ”ë°...  
* ë¬´ì˜ë¯¸í•œ ë…¸ê°€ë‹¤ì— ìµìˆ™í•´ì§€ë©´ ì•ˆë¨.. ì¢‹ì€ ë°©ë²•ì´ ìˆë‹¤ë©´ ë¹ ë¥´ê²Œ ì ìš©í•´ì•¼í•¨.
* ì§€ë©´ì˜ pom.xmlì„ ë³´ë‹ˆ ì—¬ê¸°ëŠ” Spring 4ë¡œ ë˜ì–´ìˆìŒ... ì´ì „ê¹Œì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³µì‚¬ëŠ” Spring 3.0 ì´ì˜€ë˜ ê²ƒ ê°™ë˜ë°...



## 27.5 ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°

* ...



## 27.6 STS í”„ë¡œì íŠ¸ ì‹¤í–‰í•˜ê¸°

* ...
* `favicon.ico`ì„ ë„£ê¸´í–ˆëŠ”ë°.. ì œëŒ€ë¡œ ì“¸ë ¤ë©´ Context Pathë¥¼ /ë¡œ í•´ì•¼ ë¸Œë¼ìš°ì €ì—ì„œ ì •ìƒ ì¸ì‹í•œë‹¤.



## 27.7 STS í™˜ê²½ì—ì„œ ë§ˆì´ë°”í‹°ìŠ¤ ì‚¬ìš©í•˜ê¸°

* ...

* Oracle ë“œë¼ì´ë²„ê°€ ì•„ë§ˆë„... 2014ë…„ì—ë„ Maven ë ˆíŒŒì§€í† ë¦¬ë¡œ ë°›ì„ ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ì€ë°..

  * https://mvnrepository.com/artifact/oracle/ojdbc6/11.2.0.3

  * ê·¸ëŸ°ë°...  ì´ë¶€ë¶„ ê°™ì€ ê²½ìš°ëŠ” í˜¸í™˜ì„± ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆì–´ ì •í™•íˆ ë²„ì „ ë§ì¶œë ¤ê³  ê·¸ë¬ì„ ìˆ˜ë„ ìˆê² ë‹¤.

  * ë‚˜ëŠ” ê·¸ëƒ¥ ojdbc 8ë¡œ ì“°ê³  ìˆìŒ. (OracleXE 18c)

    ```groovy
    runtimeOnly "com.oracle.database.jdbc:ojdbc8:${ojdbcVersion}"
    ```

    

## 27.8 log4jë€?

* ...
* ë¡œê±°ë„ System.out ì¶œë ¥ë³´ë‹¤ëŠ” ì§„ë„ ì´ˆë°˜ì— ì„¤ì •í•´ë‘ê³  ì“°ëŠ”ê²Œ ì¢‹ê¸´í–ˆë‹¤...
* Log4jì˜ ì´ì „ ë²„ì „ë“¤ì€ ì·¨ì•½ì ì´ ë§ì•„ì„œ í•­ìƒ ìµœì‹  ë²„ì „ì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ.
  * ê·¼ë˜ì— ì‹¬ê°í•œ ì›ê²© ì½”ë“œ ì‹¤í–‰ ì·¨ì•½ì  ê´€ë ¨í•´ì„œ ì¬í˜„ì„ í•´ë´¤ìŒ.
    * https://github.com/mklinkj/log4j2-test



### 27.8.2 MyBatis SQLë¬¸ì„ ë¡œê·¸ë¡œ ì¶œë ¥í•˜ê¸°

* ...

* ROOTë¡œê·¸ë¥¼ debugë¡œ ì„¤ì •í•˜ë¼ê³  ì„¤ëª…ì„ í•˜ì…¨ëŠ”ë°...

* ê³µì‹ ë¬¸ì„œì— ë”°ë¥´ë©´... Mapper ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ TRACEë ˆë²¨ë¡œ ë¡œê¹…ì„ ì§€ì •í•´ì£¼ë©´ ë¨.. ë‚˜ë„ ê·¸ë ‡ê²Œí•˜ê³  ìˆê³ ..

  * https://github.com/mklinkj/log4j2-test

    ```xml
    <Logger name="org.mklinkj.taojwp.member.mapper.MemberMapper" level="TRACE"/>
    ```

    





























---

## ì§„í–‰

* ...
  



## ì˜ê²¬

* ...




## ì •ì˜¤í‘œ

* ...






## ê¸°íƒ€

### webjars-locatorë¥¼ ì‚¬ìš©í•´ë„ ì´ìƒí•˜ê²Œ ë²„ì „ëª…ì‹œí•´ì•¼ ì ‘ê·¼ë˜ëŠ” ë¬¸ì œê°€ ìˆì–´ ê²€ìƒ‰..

* ê°€ì¥ ë„ì›€ ë˜ì—ˆë‹¤.
  * https://stackoverflow.com/questions/35536836/remove-webjars-version-from-url
  * ì–´ë–»ê²Œ í•˜ë”ë¼ë„ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì•„ì„œ ì§ì ‘ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œë¥¼ 

* https://www.webjars.org/documentation#springmvc
* https://github.com/spring-projects/spring-boot/blob/2.0.x/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java
* https://www.springcloud.io/post/2021-12/client-side-development-with-spring-boot-applications/#gsc.tab=0



### ì¢€  ë” ë³´ë‹ˆ.. Java 17 í™˜ê²½ì—ì„œ WebJarAssetLocatorì˜ getWebJars() ì‹¤í–‰ì‹œ ë²„ì „ ì •ë³´ë¥¼ ëª»ì½ëŠ”ë‹¤.. (ë˜ ë‚˜ì¤‘ì—” ì½ìŒ ğŸ˜†ğŸƒğŸ‘º)

```java
    WebJarAssetLocator LOCATOR = new WebJarAssetLocator();
    Map<String, String> webjars = LOCATOR.getWebJars();
```

```
{jquery=3.6.4, bootstrap=5.3.0}
```

ìœ„ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ë²„ì „ì´ ì¡°íšŒê°€ ë˜ì•¼í•˜ëŠ”ë°... ì‹¤í–‰ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ë‘ë©´ì„œ Java 17ë¡œ í™˜ê²½ì„ ì˜¬ë¦¬ë©´ 

```
{jquery=null, bootstrap=null}
```

nullë¡œ ë‚˜ì˜¤ëŠ” ê²½ìš°ê°€ ìˆì—ˆëŠ”ë°... ì§€ê¸ˆ 17ë‹¤ì‹œ ì˜¬ë¦¬ê³  ë³´ë‹ˆ ë‹¤ì‹œ ì˜ë¨.? ğŸ˜† ë¯¸ì¹˜ê² ìŒ...

ê·¸ë˜ë„ ì•Œë ¤ì§„ ì„¤ì •ìœ¼ë¡œëŠ” ì ˆëŒ€ë¡œ ë²„ì „ì—†ì´ ì‚¬ìš©í•  ìˆ˜ê°€ ì—†ì–´ì„œ.. ê²½ë¡œë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ì„±í–ˆìŒ..

```java
@Slf4j
@Controller
public class WebJarsController {
  private static final WebJarAssetLocator LOCATOR = new WebJarAssetLocator();

  @ResponseBody
  @GetMapping("/webjars_locator/{webjar}/**")
  public ResponseEntity<Resource> locateWebjarAsset(
      @PathVariable String webjar, HttpServletRequest request) {

    try {
      String version = LOCATOR.getWebJars().get(webjar);
      String mvcPrefix = String.format("/webjars_locator/%s/", webjar);
      String mvcPath =
          (String) request.getAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE);
      String fullPath =
          String.format(
              "META-INF/resources/webjars/%s/%s/%s",
              webjar, version, mvcPath.substring(mvcPrefix.length()));

      return new ResponseEntity<>(new ClassPathResource(fullPath), HttpStatus.OK);
    } catch (Exception e) {
      LOGGER.error(e.getMessage(), e);
      return new ResponseEntity<>(HttpStatus.NOT_FOUND);
    }
  }
}
```

ë‚´ë¶€ ë™ì‘ í™•ì¸ ë•Œë¬¸ì— ì´ë ‡ê²Œí•˜ê¸´ í–ˆëŠ”ë°...

* https://stackoverflow.com/questions/35536836/remove-webjars-version-from-url  ì´ ë¶„ì²˜ëŸ¼ getFullPath() ë©”ì„œë“œë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
* ê·¸ëƒ¥ ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì¼ìœ¼ë©´ ì•Œì•„ì„œ ì„¤ì •ì´ ë˜ì–´ìˆì„ í…ë°...



### ë™ì‘ì—ëŠ” ë¬¸ì œê°€ ì—†ì§€ë§Œ... ì•½ê°„ ì°ì°í•œ ë¬¸ì œê°€.... 

ì‘ë‹µì˜ Content-Type ê°’ì´ ì •í™•í•˜ê²Œ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤..

* ì‘ë‹µ í—¤ë”ì˜ Content-Typeì´ css / js ëª¨ë‘  `text/html;charset=UTF-8`  ë¡œ ë‚˜íƒ€ë‚¨ (Firefox)

  * ì›ë˜ëŒ€ë¡œë¼ë©´...

    * JavaScript:  `application/javascript;charset=UTF-8`
    * css: `text/css;charset=UTF-8`

  * WebJarsController ì˜ ë©”ì„œë“œì—ë‹¤ê°€ í™•ì¥ìë¥¼ ë³´ê³  responseì— ContentTypeì„ ì„¤ì •í•´ì£¼ë©´.. ë˜ê¸°ëŠ” ë í…Œì§€ë§Œ.. ê·¸ë ‡ê²Œ ê¹Œì§€ í•´ì•¼í•˜ëŠ”ì§€? ğŸ˜‚ğŸ˜‚ğŸ˜‚

    ```
     execute script from 'http://localhost:8090/pro27/webjars_locator/jquery/jquery.slim.min.js' because its MIME type ('application/json') is not executable, and strict MIME type checking is enabled.
    listMembers.do:1 Refused to execute script from 'http://localhost:8090/pro27/webjars_locator/bootstrap/js/bootstrap.bundle.min.js' because its MIME type ('application/json') is not executable, and strict MIME type checking is 
    ```

  * ì‹¤í–‰ì€ ë˜ê¸´ ë˜ëŠ”ë°.. ì½˜ì†” ì—ëŸ¬ê°€ ë‚˜ì„œ... ã… ã… 

    ```java
          return ResponseEntity.status(HttpStatus.OK) //
              .header(HttpHeaders.CONTENT_TYPE, getContentType(fullPath))
              .cacheControl(CacheControl.maxAge(Duration.ofDays(7)))
              .body(new ClassPathResource(fullPath));
    ```

    ë°˜í™˜í•  ë•Œ... í™•ì¥ì ë³´ê³  ì»¨í…íŠ¸ íƒ€ì…ì„ ì§€ì •í•˜ê²Œ í–ˆë‹¤..

    * íŠ¹ì´í•˜ê²Œë„ ìºì‹œë¥¼ ì„¤ì •ì•ˆí•˜ë©´ í•­ìƒ ìƒˆë¡œë°›ì•„ì„œ ì„¤ì •í•´ì•¼í–ˆë‹¤. (cssíŒŒì¼ ìì²´ê°€ ì»¤ì„œ...ã… ã… )



ê·¸ëŸ°ë° ì•„ë¬´ë¦¬ ê·¸ë˜ë„ ì›°ì¼€ ëŠë¦¬ì§€!! í™•ì¸í•´ë³´ë‹ˆ... í¬ë¡¬ ë„¤íŠ¸ì›Œí¬ íƒ­ì— `ëŠë¦° 3G`ë¡œ ì„¤ì •ë˜ì–´ìˆì—ˆìŒ ğŸ˜‚ğŸ˜‚ğŸ˜‚

![image-20230607212310921](doc-resources/image-20230607212310921.png)

ê·¸ë˜ë„ ìºì‹œ ë¬¸ì œ í™•ì¸í•˜ëŠ”ë°ëŠ” ë„ì›€ì´ ë˜ì—ˆìŒ ğŸ‘





### ì»¨í…ì¸  íƒ€ì…ì„ í™•ì¥ì ë³´ê³  ìˆ˜ë™ìœ¼ë¡œ íŒë‹¨í–ˆì—ˆëŠ”ë°...

Java 1.7ë¶€í„°ëŠ” `Files.probeContentType()`ë€ ë©”ì„œë“œê°€ ì¤€ë¹„ë˜ì–´ìˆë‹¤.

```java
Files.probeContentType(Path.of(classPathResource.getPath())))
```

cssë‚˜ javascript ë¦¬ì†ŒìŠ¤ë¥¼ ì •í™•í•˜ê²Œ íŒë‹¨í•  ìˆ˜ ìˆì—ˆë‹¤.
