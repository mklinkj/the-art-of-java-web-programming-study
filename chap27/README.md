# 27ì¥ ë©”ì´ë¸ê³¼ ìŠ¤í”„ë§ STS ì‚¬ìš©ë²•

> * ì´ë²ˆì¥ì€ ì–´ë–»ê²Œ ì§„í–‰í•´ì•¼í• ê¹Œ? ğŸƒ
>   * Maven ë¹Œë“œ í”„ë¡œì íŠ¸ ìƒì„±
>   
>     * 26ì¥ Gralde ë¹Œë“œë¡œ ì‘ì„±í•œ í”„ë¡œì íŠ¸ë¥¼ Maven ë¹Œë“œ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•´ë´ë„ ì¢‹ì„ ê²ƒ ê°™ê¸´í•˜ë‹¤.. 
>     * Gretty ëŒ€ì‹  [cargo-maven-plugin](https://codehaus-cargo.github.io/cargo/Maven+3+Plugin.html)ìœ¼ë¡œ Tomcat ì‹¤í–‰ë˜ê²Œ ì„¤ì •í•˜ì.
>   
>   * STS ì‚¬ìš©ë²•, MyBatis ì‚¬ìš© ë“±ë“±...
>   
>     * IntelliJ ì‚¬ìš©ì¤‘ì´ë‹ˆ ë„˜ì–´ê°€ì. ìš”ì¦˜ InteliJì˜ MyBatis ì§€ì›ì´ ê½¤ ì¢‹ì•„ì¡Œë‹¤. (Mapper ì¸í„°í˜ì´ìŠ¤ ë¹ˆ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ” ê²½ê³ ê°€ ìˆì–´ì™”ëŠ”ë°.. í•´ê²°ëœë“¯.)
>   
>   * Apache Log4J
>   
>     * ë¡œê¹…ì€ ìŠ¤í„°ë”” ì‹œì‘í•  ë•Œë¶€í„° ì ìš©í•´ì„œ, ì¶”ê°€ë¡œ í•  ì¼ì€ ì—†ì„ ê²ƒ ê°™ë‹¤.  `Slf4j êµ¬í˜„ìœ¼ë¡œ Log4j2 ì‚¬ìš©í•˜ê³  ìˆìŒ.`
>   
>   * Apache Tiles
>   
>     * [Tiles](https://tiles.apache.org/framework/index.html)ê°€ 2017ë…„ 3.0.8 ë²„ì „ì´í›„ë¡œ ì‹ ë²„ì „ì´ ë‚˜ì˜¤ì§€ì•Šê³  ê°œë°œ ì¤‘ë‹¨ëœ ê²ƒ ê°™ì€ë°...
>       * ìƒˆë¡œ Maven ë¹Œë“œë¡œ ë¶„ê¸°í•œ í”„ë¡œì íŠ¸ì—ëŠ” ì ìš©í•´ë´ë„ ë  ê²ƒ ê°™ê¸´í•¨.
>     * âœ¨ Gradle ë¹Œë“œ í”„ë¡œì íŠ¸ì˜ ê²½ìš°... ì•„ì§ Viewê°€ ë³µì¡í•˜ì§„ ì•Šì•„ì„œ ì´ë²ˆê¸°íšŒì— `Thymeleaf`ë¡œ ë°”ê¿”ë´ë„ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
>   
>     
>   
>     	
>   
> * ì˜ˆì œ í”„ë¡œì íŠ¸
>   * Gradle ë¹Œë“œ
>     * [pro27](pro27)
>   * Maven ë¹Œë“œ
>     * [pro27-maven](pro27-maven)



## 27.1 ë©”ì´ë¸ ì„¤ì¹˜í•˜ê¸°

* ...
* Mavenì— ëŒ€í•´ì„œëŠ” ì´ë¯¸ ì˜ ì•Œê³  ìˆê³ , ì˜ ì“°ê³ ë„ ìˆì–´ì„œ...ğŸ˜… 
* Gradle í”„ë¡œì íŠ¸ë„ Maven í”„ë¡œì íŠ¸ë¡œ ì„±ê³µì ìœ¼ë¡œ ì „í™˜í–ˆë‹¤. ğŸ‘



## 27.2 ë©”ì´ë¸ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •í•˜ê¸°

* ...



## 27.3 STS ì„¤ì¹˜í•˜ê¸°

* ...
* STSëŠ” ì•ˆì“°ê¸°ë¡œ í•¨.. IntelliJë¡œ ëª¨ë“ ê²ƒì´ ì•„ì£¼ ì˜ë˜ê³  ìˆìŒ..ğŸ˜…



## 27.4 ë©”ì´ë¸ í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ì™€ êµ¬ì„± ìš”ì†Œ

* ...
* ì†”ì§íˆ ì¼ì°Œê°ì¹˜ ë¹Œë“œ íˆ´ì„ ì“°ëŠ” ì‹ìœ¼ë¡œ ì§„ë„ê°€ êµ¬ì„±ë˜ì—ˆì–´ì•¼ í–ˆë‹¤ê³  ìƒê°ì´ ë“œëŠ”ë°...  
* ë¬´ì˜ë¯¸í•œ ë…¸ê°€ë‹¤ì— ìµìˆ™í•´ì§€ë©´ ì•ˆë¨.. ì¢‹ì€ ë°©ë²•ì´ ìˆë‹¤ë©´ ë¹ ë¥´ê²Œ ì ìš©í•´ì•¼í•¨.
* ì§€ë©´ì˜ pom.xmlì„ ë³´ë‹ˆ ì—¬ê¸°ëŠ” Spring 4ë¡œ ë˜ì–´ìˆìŒ... ì´ì „ê¹Œì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë³µì‚¬ëŠ” Spring 3.0 ì´ì˜€ë˜ ê²ƒ ê°™ë˜ë°...



## 27.5 ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°

* ...



## 27.6 STS í”„ë¡œì íŠ¸ ì‹¤í–‰í•˜ê¸°

* ...
* `favicon.ico`ì„ ë„£ê¸´í–ˆëŠ”ë°.. ì œëŒ€ë¡œ ì“¸ë ¤ë©´ Context Pathë¥¼ /ë¡œ í•´ì•¼ ë¸Œë¼ìš°ì €ì—ì„œ ì •ìƒ ì¸ì‹í•œë‹¤.



## 27.7 STS í™˜ê²½ì—ì„œ ë§ˆì´ë°”í‹°ìŠ¤ ì‚¬ìš©í•˜ê¸°

* ...

* Oracle ë“œë¼ì´ë²„ê°€ ì•„ë§ˆë„... 2014ë…„ì—ë„ Maven ë ˆíŒŒì§€í† ë¦¬ë¡œ ë°›ì„ ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ì€ë°..

  * https://mvnrepository.com/artifact/oracle/ojdbc6/11.2.0.3

  * ê·¸ëŸ°ë°...  ì´ë¶€ë¶„ ê°™ì€ ê²½ìš°ëŠ” í˜¸í™˜ì„± ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆì–´ ì •í™•íˆ ë²„ì „ ë§ì¶œë ¤ê³  ê·¸ë¬ì„ ìˆ˜ë„ ìˆê² ë‹¤.

  * ë‚˜ëŠ” ê·¸ëƒ¥ ojdbc 8ë¡œ ì“°ê³  ìˆìŒ. (OracleXE 18c)

    ```groovy
    runtimeOnly "com.oracle.database.jdbc:ojdbc8:${ojdbcVersion}"
    ```

    

## 27.8 log4jë€?

* ...
* ë¡œê±°ë„ System.out ì¶œë ¥ë³´ë‹¤ëŠ” ì§„ë„ ì´ˆë°˜ì— ì„¤ì •í•´ë‘ê³  ì“°ëŠ”ê²Œ ì¢‹ê¸´í–ˆë‹¤...
* Log4jì˜ ì´ì „ ë²„ì „ë“¤ì€ ì·¨ì•½ì ì´ ë§ì•„ì„œ í•­ìƒ ìµœì‹  ë²„ì „ì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ.
  * ê·¼ë˜ì— ì‹¬ê°í•œ ì›ê²© ì½”ë“œ ì‹¤í–‰ ì·¨ì•½ì  ê´€ë ¨í•´ì„œ ì¬í˜„ì„ í•´ë´¤ìŒ.
    * https://github.com/mklinkj/log4j2-test



### 27.8.2 MyBatis SQLë¬¸ì„ ë¡œê·¸ë¡œ ì¶œë ¥í•˜ê¸°

* ...

* ROOTë¡œê·¸ë¥¼ debugë¡œ ì„¤ì •í•˜ë¼ê³  ì„¤ëª…ì„ í•˜ì…¨ëŠ”ë°...

* ê³µì‹ ë¬¸ì„œì— ë”°ë¥´ë©´... Mapper ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ TRACEë ˆë²¨ë¡œ ë¡œê¹…ì„ ì§€ì •í•´ì£¼ë©´ ë¨.. ë‚˜ë„ ê·¸ë ‡ê²Œí•˜ê³  ìˆê³ ..

  * https://github.com/mklinkj/log4j2-test

    ```xml
    <Logger name="org.mklinkj.taojwp.member.mapper.MemberMapper" level="TRACE"/>
    ```

    

## 27.9 íƒ€ì¼ì¦ˆë€?

> * Spring 5 í”„ë¡œì íŠ¸ì¸ [pro27-maven](pro27-maven) í”„ë¡œì íŠ¸ì—ë§Œ ì ìš©í•˜ì!

#### ë””íœë˜ì‹œ ì¶”ê°€

```xml
<dependency>
    <groupId>org.apache.tiles</groupId>
    <artifactId>tiles-jsp</artifactId>
    <version>${tiles.version}</version>
</dependency>
```

* `tiles-servlet`ì€ `tiles-jsp`ê°€ ì „ì´ ì˜ì¡´ì„±ìœ¼ë¡œ ê°€ì ¸ì˜´.

### ì»¨í…ìŠ¤íŠ¸ ì„¤ì •

```xml
  <bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles3.TilesConfigurer">
    <property name="definitions">
      <list>
        <value>classpath:tiles/*.xml</value>
      </list>
    </property>
    <property name="preparerFactoryClass"
      value="org.springframework.web.servlet.view.tiles3.SpringBeanPreparerFactory"/>
  </bean>

  <mvc:view-resolvers>
    <bean class="org.springframework.web.servlet.view.tiles3.TilesViewResolver">
      <property name="viewClass" value="org.springframework.web.servlet.view.tiles3.TilesView"/>
    </bean>

    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
      <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
      <property name="prefix" value="/WEB-INF/views/"/>
      <property name="suffix" value=".jsp"/>
    </bean>
  </mvc:view-resolvers>
```

* Tiles 3 ì„¤ì •ìœ¼ë¡œ ì¼ë‹¨ì€ ì´ë ‡ê²Œ í•´ë´„... 
* ê¸°ì¡´ ë·° ê²½ë¡œë„ ê°™ì´ ì‚¬ìš©ë  ìˆ˜ ìˆê²Œ InternalResourceViewResolver ì„¤ì •ë„ ê°™ì´ ë‘ .



### ì¼ë‹¨ Bootstrapìœ¼ë¡œ ë ˆì´ì•„ì›ƒì„ êµ¬ì„±í•´ë³´ê³  ìˆëŠ”ë°...

* âœ¨ Tiles + Srpgin 5 + Maven ë¹Œë“œ í”„ë¡œì íŠ¸ì— ì˜ ì ìš©í•´ì„œ ì§„í–‰í–ˆë‹¤.  
* https://getbootstrap.kr/docs/5.2/layout/columns/



### ì°¸ê³ 

* Apache Tiles Integration with Spring MVC
  * https://www.baeldung.com/spring-mvc-apache-tiles
* Spring MVC: from JSP and Tiles to Thymeleaf
  * https://spring.io/blog/2012/10/30/spring-mvc-from-jsp-and-tiles-to-thymeleaf
* Spring MVC - Tilesë¡œ jsp êµ¬ì„±í•˜ê¸°
  * https://seypark.tistory.com/126



## Spring 6 + Gradle í”„ë¡œì íŠ¸ì— Thymeleaf ì ìš©

> Spring 5 + Maven í”„ë¡œì íŠ¸ì— Tilesë¥¼ ì„±ê³µì ìœ¼ë¡œ ì ìš©í–ˆë‹¤.
>
> ì´ë²ˆì—ëŠ” Spring 6 + Gradle í”„ë¡œì íŠ¸ì— Thymeleafë¥¼ ì˜ ì ìš©í•´ë³´ì ğŸ˜„ğŸ¤—
>
> ë¶€íŠ¸ë¼ë©´ starterë§Œ ì¶”ê°€í•˜ë©´ ë˜ê¸´ í•˜ëŠ”ë°.. ì¼ë°˜ ìŠ¤í”„ë§ì´ë¼ ì„¤ì •ì´ ì¢€ë” í•„ìš”í•˜ê¸´í•¨.



#### ë””íœë˜ì‹œ ì¶”ê°€

```groovy
implementation "org.thymeleaf:thymeleaf-spring6:${thymeleafVersion}"
implementation "org.thymeleaf.extras:thymeleaf-extras-springsecurity6:${thymeleafVersion}"
// https://mvnrepository.com/artifact/nz.net.ultraq.thymeleaf/thymeleaf-layout-dialect
implementation "nz.net.ultraq.thymeleaf:thymeleaf-layout-dialect:${thymeleafLayoutVersion}"
// https://mvnrepository.com/artifact/org.thymeleaf.extras/thymeleaf-extras-java8time
implementation "org.thymeleaf.extras:thymeleaf-extras-java8time:${thymeleafExtrasJava8timeVersion}"

```

* Spring Securityë¥¼ ì‚¬ìš©ì¤‘ì´ë‹ˆ,  `thymeleaf-extras-springsecurity6` ë„ ì¶”ê°€
* Layout ì„ í¸í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ë©´ `thymeleaf-layout-dialect` ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  í•´ì„œ ì¶”ê°€.
  * layout/decorator í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ì—¬ ì½˜í…ì¸ ì˜ ìŠ¤íƒ€ì¼ì„ ì§€ì •í•  ìˆ˜ ìˆëŠ” Thymeleafì˜ dialect.
* Java 8ì˜ LocalDateë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ì„œ... `thymeleaf-extras-java8time` ì¶”ê°€



#### ì„¤ì • ì¶”ê°€ (action-servlet.xml)

```xml
  <bean id="templateResolver"
    class="org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver">
    <property name="prefix" value="/WEB-INF/templates/"/>
    <property name="suffix" value=".html"/>
    <property name="templateMode" value="HTML"/>
    <property name="characterEncoding" value="UTF-8"/>
  </bean>

  <bean id="templateEngine" class="org.thymeleaf.spring6.SpringTemplateEngine">
    <property name="enableSpringELCompiler" value="true"/>
    <property name="messageSource" ref="messageSource" />
    <property name="additionalDialects">
      <set>
        <bean class="nz.net.ultraq.thymeleaf.layoutdialect.LayoutDialect"/>
        <bean class="org.thymeleaf.extras.springsecurity6.dialect.SpringSecurityDialect"/>
        <bean class="org.thymeleaf.extras.java8time.dialect.Java8TimeDialect"/>
      </set>
    </property>
    <property name="templateResolver" ref="templateResolver"/>
  </bean>

  <bean id="viewResolver" class="org.thymeleaf.spring6.view.ThymeleafViewResolver">
    <property name="characterEncoding" value="UTF-8"/>
    <property name="templateEngine" ref="templateEngine"/>
    <property name="order" value="1"/>
  </bean>
```

* Dialect ì„¤ì •í•  ë•Œ... `additionalDialects`ë¡œ ì„¤ì •í•´ì•¼í•¨. `dialect`ë¡œ ì„¤ì •í•˜ë©´ ê¸°ë³¸ìœ¼ë¡œ í¬í•¨ëœ ê²ƒì´ í¬í•¨ë˜ì§€ ì•Šì•„. `th:href `ê°™ì€ ê²ƒë“¤ì´ ë™ì‘í•˜ì§€ ì•ŠìŒ



#### ë©”ì‹œì§€ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©í•  ë•Œ..

```html
<div th:if="${param.error}" class="alert alert-danger" role="alert">
  <span th:text="#{login.failure}"/>
</div>
```



#### Thymeleafì—ì„œëŠ” CSRF Hidden í•„ë“œë¥¼ ì§ì ‘ ì¨ì¤˜ì•¼í•¨.

```html
<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
```

* `<sec:csrfInput>` ê°™ì´ ì“¸ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì—†ëŠ” ê²ƒ ê°™ë‹¤.



#### th:errorclass ì‚¬ìš©ì‹œ ê°’ì„ css í´ë˜ìŠ¤ ê°’ì„ í•œë²ˆ ë”°ì˜´í‘œ(`'`)ë¡œ ê°ì‹¸ì¤˜ì•¼í•¨.

```html
     <input type="password" name="pwd" th:field="*{pwd}" class="form-control"
                      th:errorclass="'form-control border-danger'" id="inputPassword3"/>
```



#### input íƒœê·¸ì—ì„œ th:fieldì™€ th:valueì˜ ì°¨ì´

**thymeleaf ì—ì„œ th:field ë¥¼ ì“°ëŠ” ê²ƒê³¼ th:valueë¥¼ ì“°ëŠ” ê²ƒì˜ ì°¨ì´ê°€ ë­”ì§€ ì•„ë‹ˆ?**

>  `th:field`ì™€ `th:value`ëŠ” Thymeleafì—ì„œ í¼ ì…ë ¥ í•„ë“œë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë‘ ê°€ì§€ ì†ì„±ì…ë‹ˆë‹¤. `th:field`ëŠ” `name`, `id`, `value` ì†ì„±ì„ ëª¨ë‘ ì„¤ì •í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê°€ëŠ¥í•œ ê²½ìš° `th:field`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ëŠ” Springê³¼ì˜ ì¶”ê°€ì ì¸ í†µí•©ì„ ì œê³µí•˜ë©° ëª¨ë“  ì¢…ë¥˜ì˜ ì…ë ¥ì— ì‘ë™í•©ë‹ˆë‹¤ Â¹.
>
> ë°˜ë©´, `th:value`ëŠ” HTMLì˜ `value` ì†ì„±ì„ ìˆ˜ì •í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `<input>` íƒœê·¸ì˜ ê°’ì„ ì„¤ì •í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
>
> ```html
> <input type="text" th:value="${model.field}">
> ```
>
> ì´ë ‡ê²Œ í•˜ë©´ `<input>` íƒœê·¸ì˜ ê°’ì´ `${model.field}`ì˜ ê°’ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤. ì¶”ê°€ ì •ë³´ê°€ í•„ìš”í•˜ì‹œë©´ ì•Œë ¤ì£¼ì„¸ìš”.
>
> 
>
> ì¶œì²˜: Bingê³¼ì˜ ëŒ€í™”, 2023. 6. 10.(1) java - Spring MVC and Thymeleaf - What's the difference between th:value and th:field .... https://stackoverflow.com/questions/54677313/spring-mvc-and-thymeleaf-whats-the-difference-between-thvalue-and-thfield-w ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (2) Difference between th:text and th:value in Thymeleaf. https://stackoverflow.com/questions/47374349/difference-between-thtext-and-thvalue-in-thymeleaf ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (3) thymeleafä¸­th:fieldå’Œth:valueçš„åŒºåˆ«_ç¥çŸ³çŸ³çš„åšå®¢-CSDNåšå®¢. https://blog.csdn.net/wh1236666/article/details/107716996 ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (4) spring-boot(thymeleaf)ä¸­th:fieldå’Œth:valueçš„åŒºåˆ« - CSDNåšå®¢. https://blog.csdn.net/qq_43279637/article/details/86406836 ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (5) Thymeleaf th:field doesn't bind the value for input text. https://stackoverflow.com/questions/54823408/thymeleaf-thfield-doesnt-bind-the-value-for-input-text ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..

ì´ê±¸ ë¬¼ì–´ë³¸ ì´ìœ ê°€ ...

```html
        <div class="col-sm-8">
          <input type="password" name="pwd" th:value="*{pwd}" class="form-control"
                      th:errorclass="'form-control border-danger'" id="inputPassword3"/>
          <span class="text-danger" th:errors="*{pwd}">ì•”í˜¸ ì…ë ¥ ì˜¤ë¥˜ ë©”ì‹œì§€</span>
        </div>
```

pwd ê°™ì€ ê²½ìš°ëŠ” ê°’ë“¤ì´ ë‹¤ìŒê³¼ ê°™ì´ ë³µì¡í•œ ê°’ì´ ë“¤ì–´ê°€ëŠ”ë°..

```
{bcrypt}$2a$10$nbBajJQNP74sZhR2/gWd5uqzfumh9yZytvho8m4c666/Zsa6Jcpta
```

ì´ê±¸ `th:field="*{pwd}"`ë¡œ ë°›ìœ¼ë©´ í‘œì‹œê°€ ì•ˆëœë‹¤.

í™•ì‹¤íˆ ì´ìœ ë¥¼ ëª¨ë¥´ê² ìŒ, ì¼ë‹¨ì€ ì´ë¶€ë¶„ì€ `th:value`ë¥¼ ì“°ê¸°ë¡œ í–ˆë‹¤.

ìœ„ì˜ ë¹™ AI ë‹µë³€ëŒ€ë¡œ fieldë¥¼ ì“°ë©´ 

```html
<input type="text" th:field="*{name}" class="form-control"
                 th:errorclass="'form-control border-danger'" />

<input type="text" class="form-control"
                 id="name" name="name" value="ìµœì¹˜ì›" />
```

id, name, value(nameì˜ ê°’) 3ê°€ì§€ë¥¼ ì „ë¶€ ì„¤ì •í•´ì¤€ë‹¤. ê·¸ëŸ°ë° ì´ë¯¸ íƒœê·¸ì— id, nameì„ ì •ì˜í•œ ìƒíƒœë¼ë©´ ê·¸ê²ƒì„ ìš°ì„ í•¨.

ê·¸ëŸ°ë° ì—¬ì „íˆ pwd í•„ë“œì— ëŒ€í•´ì„œëŠ” ê°’ì„ ì¶œë ¥í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ ë¥¼ ì˜ ëª¨ë¥´ê² ë‹¤.. ğŸƒ



#### `<script th:inline="javascript">`ì—ì„œ `th:inline="javascript"`ë¥¼ ê¼­ ì¨ì¤˜ì•¼ ë‚´ë¶€ì˜ íƒ€ì„ë¦¬í”„ ì¸ë¼ì¸ ì½”ë“œë¥¼ í•´ì„í•´ì£¼ë‹ˆ?

> ë„¤, `<script th:inline="javascript">`ë¥¼ ì‚¬ìš©í•˜ë©´ Thymeleafê°€ JavaScript `<script>` ë¸”ë¡ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‚¬ìš©í•˜ë©´ HTML í…œí”Œë¦¿ ëª¨ë“œì˜ ëª¨ë“  ê¸°ëŠ¥ì„ JavaScript ë¸”ë¡ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤Â². ë”°ë¼ì„œ Thymeleaf ë³€ìˆ˜ë¥¼ JavaScript ì½”ë“œì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ `th:inline="javascript"` ì†ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤âµ.
>
> ì¶œì²˜: Bingê³¼ì˜ ëŒ€í™”, 2023. 6. 10.(1) [Thymeleaf] JavaScript Inlining (ìë°”ìŠ¤í¬ë¦½íŠ¸ ì¸ë¼ì¸). https://maenco.tistory.com/entry/Thymeleaf-JavaScript-Inlining-ìë°”ìŠ¤í¬ë¦½íŠ¸-ì¸ë¼ì¸ ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (2) How set a JavaScript variable in Thymeleaf - Atta-Ur-Rehman Shah. https://attacomsian.com/blog/thymeleaf-set-javascript-variable ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (3) JavaScript Function Call with Thymeleaf | Baeldung. https://www.baeldung.com/thymeleaf-js-function-call ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (4) Thymeleafè¸©å‘ï¼ˆth:inline=â€œjavascriptâ€œï¼‰_è€ç§ƒçˆµçš„åšå®¢-CSDNåšå®¢. https://blog.csdn.net/weixin_49610478/article/details/108319573 ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..
> (5) Thymeleafã§JavaScriptã‚’åŸ‹ã‚è¾¼ã‚€ï¼ˆã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ï¼‰æ–¹æ³• - ãƒŸãƒ«ãƒ©ã‚¯. https://miruraku.com/java/thymeleaf/javascript/inline/ ì•¡ì„¸ìŠ¤í•œ ë‚ ì§œ 2023. 6. 10..

* ì €ê±° ì•ˆì¨ê°€ì§€ê³  ì²˜ë¦¬ê°€ ì•ˆë˜ëŠ”ì¤„ ì•Œê³  ê³ ìƒí–ˆë‹¤. ğŸƒ

  ```html
  <script th:inline="javascript">
    const result = /*[[${result}]]*/ false;
    const message = /*[[#{|modify.${result}|}]]*/ 'Modify Success Message';
    if (result) {
      alert(message);
    }
  </script>
  ```

  ê´€ë ¨í•´ì„œ ë©”ì‹œì§€ í”„ë¡œí¼í‹° ì²˜ë¦¬ë„ ì˜ í•´ê²° í–ˆë‹¤.



#### MVC í…ŒìŠ¤íŠ¸ í•  ë•Œ.. forwardedUrl() í…ŒìŠ¤íŠ¸ëŠ” ì˜ë¯¸ê°€ ì—†ì„ ê²ƒ ê°™ë‹¤.

```java
  @Test
  void testListMembersDo() throws Exception {
    mockMvc
        .perform(get("/member/listMembers.do"))
        .andDo(print())
        .andExpect(status().isOk())
        .andExpect(model().attributeExists("memberList"))
        .andExpect(view().name("member/listMembers"))
        .andExpect(forwardedUrl("/WEB-INF/views/member/listMembers.html")); // forwardedUrl ê°’ì´ null
  }
```

* forwardedUrl ì½”ë“œëŠ” ì§€ìš°ê³  viewì´ë¦„ë§Œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ë‚«ê² ë‹¤.



### ì°¸ê³  ë§í¬

* Thymeleaf 3.1: Whatâ€™s new and how to migrate
  * https://www.thymeleaf.org/doc/articles/thymeleaf31whatsnew.html
* https://www.thymeleaf.org/doc/articles/thymeleaf3migration.html
  * https://www.thymeleaf.org/doc/articles/thymeleaf3migration.html



















---

## ì§„í–‰

* ...
  



## ì˜ê²¬

* ...






## ì •ì˜¤í‘œ

* ...






## ê¸°íƒ€

### webjars-locatorë¥¼ ì‚¬ìš©í•´ë„ ì´ìƒí•˜ê²Œ ë²„ì „ëª…ì‹œí•´ì•¼ ì ‘ê·¼ë˜ëŠ” ë¬¸ì œê°€ ìˆì–´ ê²€ìƒ‰..

* ê°€ì¥ ë„ì›€ ë˜ì—ˆë‹¤.
  * https://stackoverflow.com/questions/35536836/remove-webjars-version-from-url
  * ì–´ë–»ê²Œ í•˜ë”ë¼ë„ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì•„ì„œ ì§ì ‘ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œë¥¼ 

* https://www.webjars.org/documentation#springmvc
* https://github.com/spring-projects/spring-boot/blob/2.0.x/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java
* https://www.springcloud.io/post/2021-12/client-side-development-with-spring-boot-applications/#gsc.tab=0



### ì¢€  ë” ë³´ë‹ˆ.. Java 17 í™˜ê²½ì—ì„œ WebJarAssetLocatorì˜ getWebJars() ì‹¤í–‰ì‹œ ë²„ì „ ì •ë³´ë¥¼ ëª»ì½ëŠ”ë‹¤.. (ë˜ ë‚˜ì¤‘ì—” ì½ìŒ ğŸ˜†ğŸƒğŸ‘º)

```java
    WebJarAssetLocator LOCATOR = new WebJarAssetLocator();
    Map<String, String> webjars = LOCATOR.getWebJars();
```

```
{jquery=3.6.4, bootstrap=5.3.0}
```

ìœ„ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ë²„ì „ì´ ì¡°íšŒê°€ ë˜ì•¼í•˜ëŠ”ë°... ì‹¤í–‰ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ë‘ë©´ì„œ Java 17ë¡œ í™˜ê²½ì„ ì˜¬ë¦¬ë©´ 

```
{jquery=null, bootstrap=null}
```

nullë¡œ ë‚˜ì˜¤ëŠ” ê²½ìš°ê°€ ìˆì—ˆëŠ”ë°... ì§€ê¸ˆ 17ë‹¤ì‹œ ì˜¬ë¦¬ê³  ë³´ë‹ˆ ë‹¤ì‹œ ì˜ë¨.? ğŸ˜† ë¯¸ì¹˜ê² ìŒ...

ê·¸ë˜ë„ ì•Œë ¤ì§„ ì„¤ì •ìœ¼ë¡œëŠ” ì ˆëŒ€ë¡œ ë²„ì „ì—†ì´ ì‚¬ìš©í•  ìˆ˜ê°€ ì—†ì–´ì„œ.. ê²½ë¡œë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ì„±í–ˆìŒ..

```java
@Slf4j
@Controller
public class WebJarsController {
  private static final WebJarAssetLocator LOCATOR = new WebJarAssetLocator();

  @ResponseBody
  @GetMapping("/webjars_locator/{webjar}/**")
  public ResponseEntity<Resource> locateWebjarAsset(
      @PathVariable String webjar, HttpServletRequest request) {

    try {
      String version = LOCATOR.getWebJars().get(webjar);
      String mvcPrefix = String.format("/webjars_locator/%s/", webjar);
      String mvcPath =
          (String) request.getAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE);
      String fullPath =
          String.format(
              "META-INF/resources/webjars/%s/%s/%s",
              webjar, version, mvcPath.substring(mvcPrefix.length()));

      return new ResponseEntity<>(new ClassPathResource(fullPath), HttpStatus.OK);
    } catch (Exception e) {
      LOGGER.error(e.getMessage(), e);
      return new ResponseEntity<>(HttpStatus.NOT_FOUND);
    }
  }
}
```

ë‚´ë¶€ ë™ì‘ í™•ì¸ ë•Œë¬¸ì— ì´ë ‡ê²Œí•˜ê¸´ í–ˆëŠ”ë°...

* https://stackoverflow.com/questions/35536836/remove-webjars-version-from-url  ì´ ë¶„ì²˜ëŸ¼ getFullPath() ë©”ì„œë“œë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
* ê·¸ëƒ¥ ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì¼ìœ¼ë©´ ì•Œì•„ì„œ ì„¤ì •ì´ ë˜ì–´ìˆì„ í…ë°...



### ë™ì‘ì—ëŠ” ë¬¸ì œê°€ ì—†ì§€ë§Œ... ì•½ê°„ ì°ì°í•œ ë¬¸ì œê°€.... 

ì‘ë‹µì˜ Content-Type ê°’ì´ ì •í™•í•˜ê²Œ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤..

* ì‘ë‹µ í—¤ë”ì˜ Content-Typeì´ css / js ëª¨ë‘  `text/html;charset=UTF-8`  ë¡œ ë‚˜íƒ€ë‚¨ (Firefox)

  * ì›ë˜ëŒ€ë¡œë¼ë©´...

    * JavaScript:  `application/javascript;charset=UTF-8`
    * css: `text/css;charset=UTF-8`

  * WebJarsController ì˜ ë©”ì„œë“œì—ë‹¤ê°€ í™•ì¥ìë¥¼ ë³´ê³  responseì— ContentTypeì„ ì„¤ì •í•´ì£¼ë©´.. ë˜ê¸°ëŠ” ë í…Œì§€ë§Œ.. ê·¸ë ‡ê²Œ ê¹Œì§€ í•´ì•¼í•˜ëŠ”ì§€? ğŸ˜‚ğŸ˜‚ğŸ˜‚

    ```
     execute script from 'http://localhost:8090/pro27/webjars_locator/jquery/jquery.slim.min.js' because its MIME type ('application/json') is not executable, and strict MIME type checking is enabled.
    listMembers.do:1 Refused to execute script from 'http://localhost:8090/pro27/webjars_locator/bootstrap/js/bootstrap.bundle.min.js' because its MIME type ('application/json') is not executable, and strict MIME type checking is 
    ```

  * ì‹¤í–‰ì€ ë˜ê¸´ ë˜ëŠ”ë°.. ì½˜ì†” ì—ëŸ¬ê°€ ë‚˜ì„œ... ã… ã… 

    ```java
          return ResponseEntity.status(HttpStatus.OK) //
              .header(HttpHeaders.CONTENT_TYPE, getContentType(fullPath))
              .cacheControl(CacheControl.maxAge(Duration.ofDays(7)))
              .body(new ClassPathResource(fullPath));
    ```

    ë°˜í™˜í•  ë•Œ... í™•ì¥ì ë³´ê³  ì»¨í…íŠ¸ íƒ€ì…ì„ ì§€ì •í•˜ê²Œ í–ˆë‹¤..

    * íŠ¹ì´í•˜ê²Œë„ ìºì‹œë¥¼ ì„¤ì •ì•ˆí•˜ë©´ í•­ìƒ ìƒˆë¡œë°›ì•„ì„œ ì„¤ì •í•´ì•¼í–ˆë‹¤. (cssíŒŒì¼ ìì²´ê°€ ì»¤ì„œ...ã… ã… )



ê·¸ëŸ°ë° ì•„ë¬´ë¦¬ ê·¸ë˜ë„ ì›°ì¼€ ëŠë¦¬ì§€!! í™•ì¸í•´ë³´ë‹ˆ... í¬ë¡¬ ë„¤íŠ¸ì›Œí¬ íƒ­ì— `ëŠë¦° 3G`ë¡œ ì„¤ì •ë˜ì–´ìˆì—ˆìŒ ğŸ˜‚ğŸ˜‚ğŸ˜‚

![image-20230607212310921](doc-resources/image-20230607212310921.png)

ê·¸ë˜ë„ ìºì‹œ ë¬¸ì œ í™•ì¸í•˜ëŠ”ë°ëŠ” ë„ì›€ì´ ë˜ì—ˆìŒ ğŸ‘





### ì»¨í…ì¸  íƒ€ì…ì„ í™•ì¥ì ë³´ê³  ìˆ˜ë™ìœ¼ë¡œ íŒë‹¨í–ˆì—ˆëŠ”ë°...

Java 1.7ë¶€í„°ëŠ” `Files.probeContentType()`ë€ ë©”ì„œë“œê°€ ì¤€ë¹„ë˜ì–´ìˆë‹¤.

```java
Files.probeContentType(Path.of(classPathResource.getPath())))
```

cssë‚˜ javascript ë¦¬ì†ŒìŠ¤ë¥¼ ì •í™•í•˜ê²Œ íŒë‹¨í•  ìˆ˜ ìˆì—ˆë‹¤.



### ê·¸ë™ì•ˆ ì˜ˆì œ í”„ë¡œì íŠ¸ì— Content Pathë¥¼ í”„ë¡œì íŠ¸ ì´ë¦„ìœ¼ë¡œ ì§€ì •í–ˆëŠ”ë°,  ê·¸ëƒ¥ `/`ë¡œ í•´ë„ ë  ê²ƒ ê°™ë‹¤.

* Tocmat í•˜ë‚˜ì— ì—¬ëŸ¬ê°œ ë„ìš¸ ê²ƒë„ ì•„ë‹ˆì—¬ì„œ... ğŸ˜…
* ê·¼ë˜ì˜ ì¶”ì„¸ëŠ” ê·¸ëƒ¥ ì•ë‹¨ì— L4ë‚˜ HTTPë‘ê³  ë„ë©”ì¸ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¦¬í•˜ëŠ” ì¶”ì„¸ë¼ì„œ..



### Tilesë¥¼ ì ìš©í•˜ê³ ë‚˜ì„œ MVC í…ŒìŠ¤íŠ¸ì˜ forward URLì´  ë ˆì´ì•„ì›ƒ JSP ë¡œë§Œ ë³´ê²Œë˜ëŠ” í˜„ìƒ

```
...
java.lang.AssertionError: Forwarded URL expected:</WEB-INF/views/member/memberForm.jsp> but was:</WEB-INF/views/common/layout.jsp>
í•„ìš”:/WEB-INF/views/member/memberForm.jsp
ì‹¤ì œ   :/WEB-INF/views/common/layout.jsp
...
```

> **Spring MVC í”„ë¡œì íŠ¸ì— Tiles ë¥¼ ì ìš©í•˜ê³ ë‚˜ì„œ... .andExpect(forwardedUrl("í¬ì›Œë”©URL")); ìœ„ í…ŒìŠ¤íŠ¸ ê²€ì¦ì„ í•  ë•Œ... í¬ì›Œë”© URLì´ í•­ìƒ Tilesì˜ ë ˆì´ì•„ì›ƒ JSPë¡œ ì„¤ì •ë˜ëŠ”ë°... ì„¸ë¶€ ì„¤ì •ì„ í•  ìˆ˜ê°€ ì—†ëŠ” ê²ƒì´ë‹ˆ?**
>
> > Tilesë¥¼ ì‚¬ìš©í•˜ëŠ” Spring MVC ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” `forwardedUrl()` ë©”ì†Œë“œë¡œ ë·° ì´ë¦„ì„ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. JSP í˜ì´ì§€ì˜ ë‚´ìš©ì€ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆì— ì˜í•´ ë Œë”ë§ë˜ê¸° ë•Œë¬¸ì—, Spring MVC Testì—ì„œëŠ” ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— JSP í˜ì´ì§€ì˜ ë‚´ìš©ì— ëŒ€í•œ ê²€ì¦ì€ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. [ë”°ë¼ì„œ ë·° ì´ë¦„ì´ ì˜¬ë°”ë¥¸ì§€, ê·¸ë¦¬ê³  ìš”ì²­ì´ ì˜¬ë°”ë¥¸ URLë¡œ ì „ë‹¬ë˜ì—ˆëŠ”ì§€ë§Œ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤](https://stackoverflow.com/questions/28944538/empty-content-in-spring-mvc-test). ì´ ì  ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
>
> 

ìŒ.. ì¼ë‹¨ ì–´ì©”ìˆ˜ ì—†ì´... `/WEB-INF/views/common/layout.jsp` ë§Œ ê²€ì‚¬í•´ì•¼ê² ë‹¤.. ğŸ˜…



### ì•”í˜¸í™”ëœ ì•”í˜¸ ì˜ì—­ì´ ë„ˆë¬´ ê¸¸ì–´ì„œ, ì¤„ì—¬ì„œ í‘œì‹œë˜ë„ë¡ ..

```html
          <td>
            <span class="d-inline-block text-truncate" style="max-width: 150px">
              ${mem.pwd}
            </span>
          </td>
```

* [Text truncation Â· Bootstrap v5.3 (getbootstrap.com)](https://getbootstrap.com/docs/5.3/helpers/text-truncation/)
