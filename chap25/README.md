# 25μ¥ μ¤ν”„λ§ νΈλμ­μ… κΈ°λ¥ μ‚¬μ©ν•κΈ°

> * νΈλμ­μ…μ€ μ–Έμ λ‚ μ¤‘μ”ν•λ‹¤..π‘
> * μμ  ν”„λ΅μ νΈ: 
>   * [pro25](pro25)



## 25.1 νΈλμ μ… κΈ°λ¥

* ...

* νΈλμ μ…μ€ μ»¤λ„¥μ… λ‹¨μ„μ΄κΈ° λ•λ¬Έμ— DataSourceλ΅ νΈλμ μ… λ©”λ‹μ €λ¥Ό μƒμ„±ν•΄μ£Όλ©΄ λ¨.

  * https://mybatis.org/spring/ko/transactions.html

    

## 25.2 μ€ν–‰ κ³„μΆ μ΄μ±„λ¥Ό ν†µν• νΈλμ­μ… κΈ°λ¥

* ...

  

## 25.3 μ¤ν”„λ§μ νΈλμ­μ… μ†μ„± μ•μ•„λ³΄κΈ°

* ...



## 25.4 μ¤ν”„λ§ νΈλμ­μ… κΈ°λ¥ μ μ©ν•΄ κ³„μΆ μ΄μ²΄ μ‹¤μµν•κΈ°

* ...

* HSQLDBλ΅ λ¨Όμ € ν•΄λ³΄κ³ ... λ™μ‘μ μ°¨μ΄κ°€ μμ–΄ ν™•μΈμ΄ ν•„μ”ν•λ‹¤λ©΄ Oracle 18cμ— μ μ©ν•΄λ³΄μ.

  * μ§„ν–‰μ„ λ‹¤ν•΄λ³΄λ‹. λ‹¨μ λ΅¤λ°± ν…μ¤νΈμ—¬μ„...  Oracle κΉμ§€ ν™•μΈν•  ν•„μ”λ” μ—†μ„ κ²ƒ κ°™λ‹¤.

    

* νΈλμ μ… μ„¤μ •μ€ μ„λΉ„μ¤ μ»¨ν…μ¤νΈ μ„¤μ •μ— λ„£μ—μ.

  ```xml
   <tx:annotation-driven/>
  
    <bean id="transactionManager"
      class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
      <constructor-arg name="dataSource" ref="dataSource"/>
    </bean>
  ```

  * νΈλμ μ… λ©”λ‹μ € μ΄λ¦„μ„ transactionManagerλ΅ μ‚¬μ©ν•λ©΄ ` <tx:annotation-driven/>`μ—μ„ μ΄λ¦„μ„ μƒλµν•  μ μμ.



---

## μ§„ν–‰

* ...
  



## μκ²¬

* μ§„μ§ κΈ°λ³Έμ μΈ νΈλμ μ… λ™μ‘λ§ ν™•μΈν–λ‹¤. π…
* account ν¨ν‚¤μ§€ μ΄ν•λ” κ·Έλƒ¥ λ„λ¬΄ λ‹¨μν•΄μ„ ν…μ¤νΈ μ½”λ“λ” κµ³μ΄ μ¶”κ°€ν•μ§„ λ§μ..π…π…π…
* κ·Έλ°λ° μ§€κΈ μ‘μ„±ν• μμ μ—μ„ `Controller <-> Service <-> Mapper` ν•μ‹μΌλ΅ μ“°κ³  μλ”λ°... Repositoryλ¥Ό μƒλµν• κ²ƒμ„ μΆ‹μ§€ μ•μ€ ν¨ν„΄μΌλ΅ λ³΄λ” κ²ƒ κ°™κΈ°λ„ν•λ°...
  * μ΄λ° μƒνƒμ—μ„λ” κµ³μ΄   `Controller <-> Service <-> Repository <-> Mapper` λ΅ μ“Έν•„μ” μ—†μ„ κ²ƒ κ°™μ€λ°.. μ–΄μ°¨ν”Ό `Repository <-> Mapper`  μ‚¬μ΄λ” μ¶”κ°€ λ΅μ§μ—†μ΄  λ‹¨μμ΄ λ°”μ΄ν¨μ¤λ§ ν•κ²λ  κ²ƒ κ°™μ•„μ„... μ§„μ§ μλ―Έκ°€ μ—†μ–΄λ³΄μ΄κΈ΄ν•λ”λ°... MyBatisλ¥Ό κ±·μ–΄λ‚Όλ•λ¥Ό κ³ λ ¤ν•λ”κ±΄κ°€?
  * κ·Έλ°λ° Spring @Repository μ–΄λ…Έν…μ΄μ…μ΄ μμ™Έκ°€ λ‚λ©΄ λ­”κ°€ λ” ν•΄μ£Όλ”κ² μλ‹¤κ³  λ“¤μ€κ² μκΈ΄ν•λ°.. μƒκ°μ΄ μ•λ‚λ‹¤. π“




## μ •μ¤ν‘

* ...



## κΈ°νƒ€

### `@BeforeTransaction`, `@AfterTransaction`μ€ μ–Έμ  μ‚¬μ©ν• κΉ?

**`@BeforeTransaction`**

> Springμ `@Transactional` μ–΄λ…Έν…μ΄μ…μ„ ν†µν•΄ νΈλμ­μ… λ‚΄μ—μ„ μ‹¤ν–‰λλ„λ΅ κµ¬μ„±λ ν…μ¤νΈ λ©”μ„λ“μ— λ€ν•΄ νΈλμ­μ…μ΄ μ‹μ‘λκΈ° μ „μ— μ–΄λ…Έν…μ΄μ…μ΄ λ‹¬λ¦° void λ©”μ„λ“κ°€ μ‹¤ν–‰λμ–΄μ•Ό ν•¨μ„ λ‚νƒ€λ‚΄λ” ν…μ¤νΈ μ–΄λ…Έν…μ΄μ…μ…λ‹λ‹¤.
> μνΌν΄λμ¤ λλ” μΈν„°νμ΄μ¤ κΈ°λ³Έ λ©”μ„λ“λ΅ μ„ μ–Έλ `@BeforeTransaction` λ©”μ„λ“λ” ν„μ¬ ν…μ¤νΈ ν΄λμ¤μ λ©”μ„λ“λ³΄λ‹¤ λ¨Όμ € μ‹¤ν–‰λ©λ‹λ‹¤.
> μ΄ μ–΄λ…Έν…μ΄μ…μ€ λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μΌλ΅ μ‚¬μ©λμ–΄ μ‚¬μ©μ μ •μ κµ¬μ„±λ μ–΄λ…Έν…μ΄μ…μ„ μƒμ„±ν•  μ μμµλ‹λ‹¤.
> Spring ν”„λ μ„μ›ν¬ 4.3λ¶€ν„° @BeforeTransactionμ€ Java 8 κΈ°λ° μΈν„°νμ΄μ¤ κΈ°λ³Έ λ©”μ„λ“μ—μ„λ„ μ„ μ–Έν•  μ μμµλ‹λ‹¤.

**`@AfterTransaction`**

> Springμ `@Transactional` μ–΄λ…Έν…μ΄μ…μ„ ν†µν•΄ νΈλμ­μ… λ‚΄μ—μ„ μ‹¤ν–‰λλ„λ΅ κµ¬μ„±λ ν…μ¤νΈ λ©”μ„λ“μ— λ€ν•΄ νΈλμ­μ…μ΄ μΆ…λ£λ ν›„ μ–΄λ…Έν…μ΄μ…λ void λ©”μ„λ“κ°€ μ‹¤ν–‰λμ–΄μ•Ό ν•¨μ„ λ‚νƒ€λ‚΄λ” ν…μ¤νΈ μ–΄λ…Έν…μ΄μ…μ…λ‹λ‹¤.
> μνΌν΄λμ¤ λλ” μΈν„°νμ΄μ¤ κΈ°λ³Έ λ©”μ„λ“λ΅ μ„ μ–Έλ `@AfterTransaction` λ©”μ„λ“λ” ν„μ¬ ν…μ¤νΈ ν΄λμ¤μ λ©”μ„λ“ λ‹¤μμ— μ‹¤ν–‰λ©λ‹λ‹¤.
> μ΄ μ–΄λ…Έν…μ΄μ…μ€ λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μΌλ΅ μ‚¬μ©λμ–΄ μ‚¬μ©μ μ •μ κµ¬μ„±λ μ–΄λ…Έν…μ΄μ…μ„ μƒμ„±ν•  μ μμµλ‹λ‹¤.
> Spring ν”„λ μ„μ›ν¬ 4.3λ¶€ν„° @AfterTransactionμ€ Java 8 κΈ°λ° μΈν„°νμ΄μ¤ κΈ°λ³Έ λ©”μ„λ“μ—μ„λ„ μ„ μ–Έν•  μ μμµλ‹λ‹¤.

μ „μ— AutoIncrement κ°’ μ΄κΈ°ν™”ν• λ ¤κ³  μ“°λ ¤λ‹¤ λ§μ•λ”λ°... μ•„μ§ κΌ­ ν•„μ”ν• λ¶€λ¶„μ΄ μμ„μ§€λ” μ λ¨λ¥΄κ² μ.
